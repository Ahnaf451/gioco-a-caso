<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flappy Pasta XL</title>
    <style>
        body { 
            margin: 0; 
            overflow: hidden; 
            background: #4ec0ca; 
            font-family: 'Segoe UI', sans-serif; 
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }
        canvas { 
            background: #70c5ce; 
            border: 5px solid #fff;
            border-radius: 15px;
            box-shadow: 0 0 30px rgba(0,0,0,0.3);
            max-width: 95vw;
            max-height: 90vh;
        }
        #ui {
            position: absolute;
            top: 20px;
            color: white;
            font-size: 32px;
            font-weight: bold;
            text-shadow: 3px 3px 0px #000;
            pointer-events: none;
        }
    </style>
</head>
<body>

    <div id="ui">Punti: <span id="score">0</span></div>
    <canvas id="gameCanvas"></canvas>

    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");
        const scoreElement = document.getElementById("score");

        // Dimensioni GRANDI
        canvas.width = 600; 
        canvas.height = 800;

        const playerImg = new Image();
        playerImg.src = "WhatsApp Image 2026-02-07 at 16.59.47.jpeg";

        // Parametri Semplificati (Modalit√† Relax)
        let bird = { 
            x: 80, 
            y: 300, 
            w: 100, // Immagine gigante
            h: 100, 
            gravity: 0.3, // Gravit√† leggerissima
            lift: -7,     // Salto dolce
            velocity: 0 
        };

        let pipes = [];
        let score = 0;
        let frame = 0;
        let isGameOver = false;
        const GAP = 300; // SPAZIO ENORME tra i tubi (difficilissimo sbagliare!)

        function createPipe() {
            let topHeight = Math.random() * (canvas.height / 2) + 50;
            pipes.push({
                x: canvas.width,
                top: topHeight,
                w: 80,
                passed: false
            });
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            // Disegna Giocatore
            ctx.drawImage(playerImg, bird.x, bird.y, bird.w, bird.h);

            // Fisica
            bird.velocity += bird.gravity;
            bird.y += bird.velocity;

            // Disegna e muovi Tubi
            for (let i = pipes.length - 1; i >= 0; i--) {
                let p = pipes[i];
                p.x -= 2.5; // Velocit√† lenta

                // Tubo superiore
                ctx.fillStyle = "#2ecc71";
                ctx.fillRect(p.x, 0, p.w, p.top);
                // Tubo inferiore
                ctx.fillRect(p.x, p.top + GAP, p.w, canvas.height);

                // Collisione (molto permissiva)
                if (bird.x + 10 < p.x + p.w &&
                    bird.x + bird.w - 10 > p.x &&
                    (bird.y + 10 < p.top || bird.y + bird.h - 10 > p.top + GAP)) {
                    isGameOver = true;
                }

                // Punto guadagnato
                if (!p.passed && p.x + p.w < bird.x) {
                    score++;
                    scoreElement.innerText = score;
                    p.passed = true;
                }

                if (p.x + p.w < 0) pipes.splice(i, 1);
            }

            // Limiti schermo
            if (bird.y > canvas.height - bird.h) {
                bird.y = canvas.height - bird.h;
                bird.velocity = 0;
            }
            if (bird.y < 0) bird.y = 0;

            if (isGameOver) {
                ctx.fillStyle = "rgba(0,0,0,0.6)";
                ctx.fillRect(0,0, canvas.width, canvas.height);
                ctx.fillStyle = "white";
                ctx.textAlign = "center";
                ctx.font = "50px Arial";
                ctx.fillText("OPS! ü§å", canvas.width/2, canvas.height/2);
                ctx.font = "25px Arial";
                ctx.fillText("Clicca o Spazio per riprovare", canvas.width/2, canvas.height/2 + 60);
                return;
            }

            if (frame % 120 === 0) createPipe();
            frame++;
            requestAnimationFrame(draw);
        }

        function reset() {
            bird.y = 300;
            bird.velocity = 0;
            pipes = [];
            score = 0;
            scoreElement.innerText = score;
            isGameOver = false;
            frame = 0;
            draw();
        }

        // Input semplici
        const handleAction = () => {
            if (isGameOver) reset();
            else bird.velocity = bird.lift;
        };

        window.addEventListener("keydown", (e) => { if(e.code === "Space") handleAction(); });
        canvas.addEventListener("mousedown", handleAction);
        canvas.addEventListener("touchstart", (e) => { e.preventDefault(); handleAction(); });

        playerImg.onload = draw;
    </script>
</body>
</html>
