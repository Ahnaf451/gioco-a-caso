<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flappy Pasta Edition</title>
    <style>
        body { margin: 0; overflow: hidden; background: #70c5ce; font-family: 'Arial', sans-serif; }
        canvas { display: block; margin: auto; background: #70c5ce; border: 2px solid #000; }
        #instructions {
            position: absolute; top: 10px; width: 100%; text-align: center;
            color: white; font-size: 20px; text-shadow: 2px 2px #000;
        }
    </style>
</head>
<body>

    <div id="instructions">Premi **SPAZIO** o **TOCCA** per volare!</div>
    <canvas id="gameCanvas"></canvas>

    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");

        // Adatta il canvas allo schermo
        canvas.width = 400;
        canvas.height = 600;

        // Caricamento immagine
        const playerImg = new Image();
        playerImg.src = "WhatsApp Image 2026-02-07 at 16.59.47.jpeg";

        // Variabili di gioco
        let bird = { x: 50, y: 150, w: 50, h: 50, gravity: 0.6, lift: -10, velocity: 0 };
        let pipes = [];
        let frame = 0;
        let score = 0;
        let gameOver = false;

        function Pipe() {
            this.top = Math.random() * (canvas.height / 2);
            this.bottom = Math.random() * (canvas.height / 2);
            this.x = canvas.width;
            this.w = 50;
            this.speed = 3;

            this.show = function() {
                ctx.fillStyle = "#2ecc71";
                ctx.fillRect(this.x, 0, this.w, this.top);
                ctx.fillRect(this.x, canvas.height - this.bottom, this.w, this.bottom);
            };

            this.update = function() {
                this.x -= this.speed;
            };
        }

        function reset() {
            bird.y = 150;
            bird.velocity = 0;
            pipes = [];
            score = 0;
            frame = 0;
            gameOver = false;
            loop();
        }

        function draw() {
            // Sfondo
            ctx.fillStyle = "#70c5ce";
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Giocatore (la tua immagine)
            ctx.drawImage(playerImg, bird.x, bird.y, bird.w, bird.h);

            // Tubi
            for (let i = pipes.length - 1; i >= 0; i--) {
                pipes[i].show();
                pipes[i].update();

                // Collisione
                if (bird.x < pipes[i].x + pipes[i].w &&
                    bird.x + bird.w > pipes[i].x &&
                    (bird.y < pipes[i].top || bird.y + bird.h > canvas.height - pipes[i].bottom)) {
                    gameOver = true;
                }

                if (pipes[i].x < -pipes[i].w) {
                    pipes.splice(i, 1);
                    score++;
                }
            }

            // Fisica gravitÃ 
            bird.velocity += bird.gravity;
            bird.y += bird.velocity;

            if (bird.y > canvas.height || bird.y < 0) gameOver = true;

            // Testo punteggio
            ctx.fillStyle = "white";
            ctx.font = "30px Arial";
            ctx.fillText("Score: " + score, 10, 50);

            if (gameOver) {
                ctx.fillStyle = "rgba(0,0,0,0.5)";
                ctx.fillRect(0,0, canvas.width, canvas.height);
                ctx.fillStyle = "white";
                ctx.textAlign = "center";
                ctx.fillText("HAI PERSO!", canvas.width/2, canvas.height/2);
                ctx.font = "20px Arial";
                ctx.fillText("Premi Spazio per rifare", canvas.width/2, canvas.height/2 + 40);
                return;
            }

            if (frame % 90 === 0) pipes.push(new Pipe());
            frame++;
            requestAnimationFrame(loop);
        }

        function loop() {
            if (!gameOver) draw();
        }

        // Controlli
        window.addEventListener("keydown", (e) => {
            if (e.code === "Space") {
                if (gameOver) reset();
                else bird.velocity = bird.lift;
            }
        });

        canvas.addEventListener("touchstart", () => {
            if (gameOver) reset();
            else bird.velocity = bird.lift;
        });

        playerImg.onload = () => loop();
    </script>
</body>
</html>
